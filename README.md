# Design Patterns

## Patrones seleccionados

### 1. Singleton (Creacional)
- **Problema:** Se requiere una sola instancia para manejar la configuración y la conexión a la base de datos.
- **Aplicación:** Clase `DatabaseConnection` asegurará una única conexión compartida por todos los módulos.
- **Beneficios:** Evita múltiples conexiones, centraliza la configuración.

### 2. Repository (Estructural)
- **Problema:** Separar la lógica de negocio de la persistencia de datos.
- **Aplicación:** Repositorios `UsuarioRepository`, `ViajeRepository`, etc., que encapsulan consultas y operaciones de la base de datos.
- **Beneficios:** Facilita pruebas unitarias, cambio de motor de BD sin alterar la lógica de dominio.

### 3. Observer / Publisher–Subscriber (Comportamiento)
- **Problema:** Enviar notificaciones en tiempo real cuando se actualiza un viaje o se acepta una solicitud.
- **Aplicación:** El módulo de notificaciones se suscribe a eventos del módulo de viajes y emite mensajes a los usuarios.
- **Beneficios:** Desacopla el emisor de los receptores, facilita añadir nuevos canales de notificación.

### 4. Strategy (Comportamiento)
- **Problema:** Permitir distintos cálculos de tarifas o métodos de pago.
- **Aplicación:** Una interfaz `PaymentStrategy` con implementaciones para tarjeta, efectivo, billetera digital.
- **Beneficios:** Permite añadir nuevos métodos sin cambiar la lógica central.

### 5. Factory Method (Creacional)
- **Problema:** Crear objetos de notificación (Push, Email, SMS) sin acoplar el código a clases concretas.
- **Aplicación:** `NotificationFactory` devolverá el tipo de notificación adecuado según configuración.
- **Beneficios:** Centraliza la creación y facilita la extensión.



![Descripción de la imagen](/img/diagramasrelacionaldebasesdedatos.png)



### 4.2.X.1 Architectural Design Backlog N

| ID | Tipo | Driver (Descripción) | Prioridad | Historias / TS relacionadas | Componentes afectados | Criterios de aceptación | Notas / Riesgos |
|----|------|----------------------|-----------:|----------------------------|----------------------|-------------------------|-----------------|
| ADB-01 | Funcional | **Registro y autenticación de usuarios**: flujo de registro con verificación por correo, login con JWT, recuperación y cambio de contraseña. | Alta | US01, TS01, US03, TS02, US02, US07 | Auth Service, User Service, Email Service, DB `usuario`, API Gateway, Security middleware | - POST /api/auth/register retorna 201 y crea usuario no verificado. - Se envía correo con token de verificación (link). - POST /api/auth/login devuelve access token (JWT) y refresh token. - Flujo de recuperación de contraseña envía link y permite cambiar contraseña. | Uso de hashing seguro (bcrypt/argon2). JWT short-lived + refresh tokens. Riesgo: envío de correo (proveedor). |
| ADB-02 | Funcional | **Alta y verificación de conductores / carga de documentos** (DNI, carné universitario, licencia, datos de vehículo). | Alta | US17, US18, US08, TS05 | Driver Service, Identity Validation Service (externo), File Storage (S3), DB `conductor` | - Registro conductor persiste datos del vehículo. - Subida de documentos queda almacenada y se registra estado de verificación. - Integración con servicio externo devuelve `{valid:true/false}` y actualiza `verificado`. | Riesgo: latencia/errores del servicio externo; mitigar con reintentos y revisión manual. |
| ADB-03 | Funcional | **Publicación de viajes por conductor** (ruta, horario, cupos, costo). | Alta | US19, TS03 | Trip Service, Search/Query API, DB `viaje` | - POST /api/trips crea viaje con estado `publicado`. - Viaje aparece en consultas y filtros (origen, destino, fecha). | Indexar campos de búsqueda en DB. Validar integridad de datos. |
| ADB-04 | Funcional | **Solicitud para unirse a un viaje y control de concurrencia** (evitar duplicados y sobreventa de asientos). | Alta | US10, TS04, US09 | Trip Service, Request Service, DB `solicitud_viaje`, Notification Service | - POST /api/trips/{id}/join retorna 200 si se crea solicitud. - Si ya solicitó: 409. - Si cupos completos: respuesta y no crear solicitud. - Consistencia ACID en decremento/lock de asientos. | Implementar transacciones/optimistic locking para evitar sobreventa. |
| ADB-05 | Funcional | **Gestión de solicitudes por conductor (aceptar/rechazar)** y notificación al pasajero. | Alta | US20, US11 | Trip Service, Request Service, Notification Service, DB `solicitud_viaje` | - Cambio de estado `aceptada`/`rechazada` persiste. - Notificación enviada en tiempo real y por fallback (email). | Validar roles y autorización (solo conductor propietario puede aceptar). |
| ADB-06 | Funcional / NFR | **Notificaciones en tiempo real** (aceptación/rechazo, alerts de demanda). Base para eventos. | Alta | US11, US24 | Notification Service (pub/sub), WebSocket Gateway, Message Broker (e.g., RabbitMQ/Redis), DB `notificacion` | - Evento de cambio relevante publica mensaje en broker. - Usuarios suscritos reciben evento vía WebSocket en < 2s. - Fallback: notificación persistida y envío por correo/SMS si necesario. | Pendiente seleccionar tecnología de mensajería (RabbitMQ vs Redis vs Kafka). |
| ADB-07 | Funcional | **Chat por viaje** (habilitado tras aceptación) y almacenamiento de mensajes. | Media/Alta | US06, US13, US22 | Chat Service (WebSockets), DB `chat` y `mensaje` (o store rápido), Gateway | - Solo usuarios aceptados/publicados pueden escribir en chat del viaje. - Mensajes llegan en tiempo real y se persisten. | Evaluar uso de DB relacional (mensajes persistentes) + cache para últimos N mensajes. Riesgo: alta I/O si mensajes masivos. |
| ADB-08 | Funcional | **Calificación post-viaje y reputación** (guardar puntuaciones y comentarios, cálculo promedio). | Media | US12, US21 | Rating Service, DB `calificacion`, User Profile | - Registro de calificación asociado a viaje. - Cálculo o agregación de promedio visible en perfil de conductor. | Decidir recalculo en write o batch. |
| ADB-09 | Funcional | **Historial de viajes y finanzas** (historial pasajero y ganancias conductor). | Media | US15, US23, historial_pago | History Service, Payments DB (`historial_pago`), UI | - Consultas por usuario devuelven historial con filtros por fecha y tipo. - Ganancias por conductor agregadas correctamente. | Si se integra pasarela de pagos, considerar conciliación. |
| ADB-10 | Funcional | **Reporte de incidentes** (registro y triaje). | Media | US25 | Reports Service, DB `reporte_incidente`, Admin Dashboard | - Reporte creado con motivo y descripción. - Administrador puede acceder al registro. | Privacidad y almacenamiento seguro de datos sensibles. |
| ADB-11 | Calidad (Seguridad) | **Seguridad global**: TLS en transporte, hashing de contraseñas, RBAC, validaciones de entrada, rate limiting, protección contra CSRF/OWASP. | Alta | — | Todos los servicios (Auth Service crítico), API Gateway, DB | - Todas las APIs detrás de TLS. - No existen contraseñas en texto plano. - Accesos a endpoints críticos requieren token válido y rol. - Rate limits aplicados. | Medir: 0 vulnerabilidades críticas en escaneo SAST básico. |
| ADB-12 | Calidad (Rendimiento / Escalabilidad) | **Respuesta y escalado**: tiempos objetivos y capacidad de escalar horizontalmente. | Alta | — | API Gateway, Caching (Redis), DB, Load Balancer | - GETs simples < 200 ms en condiciones normales. - Arquitectura soporta escalamiento horizontal (stateless services). - Cache para consultas frecuentes (búsqueda de viajes). | Meta de arranque: soportar 1k usuarios concurrentes; escalar a 10k con autoscaling. |
| ADB-13 | Calidad (Disponibilidad) | **Alta disponibilidad y tolerancia a fallos**: salud, retries, circuit breaker. | Media | — | Orquestador (Docker/K8s), Load Balancer, Monitoring/Logging | - Health checks configurados. - Retries con backoff y circuit breakers frente a servicios externos. - Monitoreo y alertas. | SLA objetivo 99.9% (a definir). |
| ADB-14 | Calidad (Mantenibilidad / Testability) | **Arquitectura modular y testable**: repositorios, DTOs, interfaces, BDD tests (.feature), CI/CD. | Alta | — | All services, Repositorios, CI pipeline | - Repositorios abstraen acceso a BD. - Tests unitarios y .feature de BDD cubren flujos críticos. - Pipeline CI ejecuta pruebas y despliega a staging automáticamente. | Uso de GitHub + GitFlow + Conventional Commits (convención). |
| ADB-15 | Restricción (Persistence) | **Base de datos relacional obligatoria**: PostgreSQL como DB primaria. Esquema relacional documentado (DBML). | Alta | DB Diagram | PostgreSQL, Migrations (Flyway/TypeORM), Backups | - Esquema implementado por migrations. - Backups diarios automáticos. | Evaluar uso complementario de NoSQL/Redis para chat/caching. |
| ADB-16 | Restricción (Despliegue) | **Contenerización y Cloud**: empaquetar servicios en Docker; despliegue en AWS (ECS/EKS) o equivalente. | Alta | — | Docker, Orquestador (ECS/EKS), CI/CD | - Imagenes Docker construidas y almacenadas en registry. - Despliegue a entorno staging reproducible. | Definir infra-as-code (Terraform/CloudFormation). |
| ADB-17 | Restricción (Servicios externos) | **Integraciones externas**: proveedor de correo/SMS, API de validación de identidad, pasarela de pago (TBD). | Alta | TS05, historial_pago | Email/SMS Provider, Identity API, Payment Gateway | - Integración con proveedor de correo con fallback. - Tratamiento de errores y límites de cuota. | Riesgo: dependencia de SLA de terceros; plan de degradado. |
| ADB-18 | Riesgo / Decisión pendiente | **Selección de mensajería y realtime stack**: RabbitMQ vs Redis Streams vs Kafka; WebSocket vs SSE. | Alta | US11, US06 | Message Broker, WebSocket Server (Socket.IO), Notification Service | - Decidir tecnología en esta iteración antes de codificar notificaciones. | Recomendación: RabbitMQ (mensajería simple, confirmaciones) + WebSocket (Socket.IO) para prototipo; evaluar Kafka si la escala lo justifica. |

---


# Student Outcomes

| Criterio específico | Acciones realizadas | Conclusiones |
|---------------------|---------------------|--------------|
| **Actualiza conceptos y conocimientos necesarios para su desarrollo profesional y en especial para su proyecto en soluciones de software.** | **Gamarra Vega, Anderson José**<br>- Redacté el Lean UX Canvas, relacionando hipótesis y supuestos con los objetivos del producto, lo que me permitió afianzar mis conocimientos en metodologías ágiles de diseño.<br>- Contribuí en la construcción del Product Backlog, aplicando técnicas de priorización que me ayudaron a fortalecer mis competencias en gestión de requisitos y planificación de software.<br><br>**Nanfuñay Liza, Pedro Jesús**<br>- Redacté puntos esenciales para el desarrollo del presente proyecto como el Lean UX Assumptions, Empathy Maps y User Stories, aplicando conocimientos adquiridos de manera eficiente y clara, y buenas prácticas que me permitieron actualizar mis conocimientos y fortalecer mis competencias en el desarrollo de software.<br><br>**Quijandria Araneda, Vicente**<br>- Desarrollé la sección de antecedentes y problemática, aplicando herramientas de análisis para contextualizar el proyecto.<br>- Participé en la redacción de User Stories, lo que me permitió reforzar mi capacidad de transformar hallazgos en especificaciones claras y accionables.<br><br>**Hallasi Saravia, Miguel Ángel**<br>- Redacté la sección de segmentos objetivo, lo cual me permitió aplicar conceptos de segmentación y análisis de usuarios.<br>- Participé activamente en entrevistas y en la construcción del Impact Map, afianzando mis conocimientos en la identificación de métricas de valor y validación de usuarios.<br><br>**Valera Garcés, Samuel Ignacio**<br>- Redacté la descripción de la startup y documenté escenarios As-Is y To-Be, lo que me ayudó a profundizar en el análisis de procesos y a fortalecer mis competencias en modelado de escenarios. | Cada integrante actualizó y aplicó conceptos fundamentales en Lean UX, análisis de usuarios y especificación de requisitos. El equipo en conjunto demostró que la aplicación práctica de estos conocimientos fortaleció sus competencias profesionales y mejoró la calidad del proyecto. |
| **Reconoce la necesidad del aprendizaje permanente para el desempeño profesional y el desarrollo de proyectos en soluciones de software.** | **Gamarra Vega, Anderson José**<br>- Al elaborar el Lean UX Canvas y priorizar el backlog, comprendí la importancia de actualizar de manera constante mis conocimientos en análisis de producto y planificación, reconociendo que el aprendizaje continuo es clave para mejorar mi desempeño profesional.<br><br>**Nanfuñay Liza, Pedro Jesús**<br>- Al redactar este informe comprendí la importancia de actualizar constantemente los conocimientos que adquiero, ya que es un aspecto fundamental para mejorar mis capacidades, desempeño profesional y en el desarrollo de proyectos de soluciones de software.<br><br>**Quijandria Araneda, Vicente**<br>- Al redactar los antecedentes y problemática y participar en la definición de historias de usuario, entendí que debo mantenerme actualizado en técnicas de análisis y documentación de requisitos para elevar mi desempeño en futuros proyectos.<br><br>**Hallasi Saravia, Miguel Ángel**<br>- Al elaborar los segmentos objetivo, realizar entrevistas y desarrollar el Impact Map, comprendí que el aprendizaje permanente es esencial para perfeccionar mis competencias en validación de usuarios y métricas de impacto.<br><br>**Valera Garcés, Samuel Ignacio**<br>- Al redactar la descripción de la startup y los escenarios As-Is/To-Be, entendí la necesidad de fortalecer constantemente mis conocimientos en mapeo de procesos y comunicación de resultados, reconociendo que el aprendizaje continuo es esencial para mi desarrollo profesional. | El equipo reconoció que el aprendizaje permanente es un pilar para el crecimiento profesional y para la mejora continua en el desarrollo de proyectos de software. La experiencia les permitió reafirmar la importancia de seguir investigando, aplicando nuevas técnicas y adaptando buenas prácticas a futuros retos. |
| **Aplica principios de arquitectura de software para diseñar soluciones escalables y mantenibles.** | **Gamarra Vega, Anderson José**<br>- Definí las tácticas de arquitectura y los Architectural Drivers, fortaleciendo mi comprensión de cómo las decisiones de diseño impactan en la escalabilidad y mantenibilidad del sistema.<br>- Establecí metas para las iteraciones ADD, lo que me permitió aplicar criterios de priorización y adaptación de la arquitectura en función de los requisitos clave.<br><br>**Nanfuñay Liza, Pedro Jesús**<br>- Redacté los principios y enfoques arquitectónicos, seleccionando estilos y patrones que mejor se alinean con las necesidades del proyecto, reforzando mis habilidades en la definición de conceptos de diseño.<br>- Elegí y documenté los Design Concepts que satisfacen los drivers seleccionados, aplicando buenas prácticas de arquitectura de software.<br><br>**Quijandria Araneda, Vicente**<br>- Elaboré el Context Diagram y los ViewPoints Diagram, lo que me permitió comprender la interacción entre los componentes del sistema y afianzar mis conocimientos en la representación de vistas arquitectónicas.<br>- Identifiqué restricciones y preocupaciones arquitectónicas, fortaleciendo mi capacidad de analizar limitaciones y riesgos en el diseño de software.<br><br>**Hallasi Saravia, Miguel Ángel**<br>- Documenté las funcionalidades principales (Primary User Stories) y los Quality Attribute Scenarios, lo cual me ayudó a relacionar los requisitos funcionales y no funcionales con la arquitectura del sistema.<br>- Desarrollé diagramas C4 y UML para las iteraciones, lo que reforzó mis competencias en la visualización de arquitecturas complejas.<br><br>**Valera Garcés, Samuel Ignacio**<br>- Diseñé el diagrama de base de datos relacional/no relacional y definí los Design Patterns del proyecto, lo que fortaleció mis habilidades en modelado de datos y en la aplicación de patrones de diseño orientados a la mantenibilidad.<br>- Dirigí las ADD Iterations y elaboré el Architectural Design Backlog, aplicando metodologías de diseño iterativo para refinar y mejorar la arquitectura del sistema. | Cada integrante aplicó de manera efectiva principios y prácticas de arquitectura de software para proponer una solución escalable y mantenible. El trabajo conjunto permitió integrar diagramas, patrones y tácticas que fortalecen la estructura del sistema y garantizan su evolución en el tiempo. |




